<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>VLibras OBS</title>
    <style>
      html, body {
        margin: 0;
        padding: 0;
        background: transparent;
        overflow: hidden;
      }
      #vlibras {
        position: fixed;
        bottom: 0;
        right: 0;
        z-index: 9999;
      }
      #textoAtual {
        position: fixed;
        bottom: 10px;
        left: 10px;
        color: white;
        font-size: 18px;
        font-family: sans-serif;
        background: rgba(0,0,0,0.6);
        padding: 8px 12px;
        border-radius: 8px;
      }
    </style>
    <script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
  </head>
  <body>
    <div id="vlibras">
      <div vw class="enabled">
        <div vw-access-button class="active"></div>
        <div vw-plugin-wrapper>
          <div class="vw-plugin-top-wrapper"></div>
        </div>
      </div>
    </div>

    <div id="textoAtual">Aguardando fala...</div>

    <script>
      new window.VLibras.Widget('https://vlibras.gov.br/app');

      const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
      if (!SR) {
        document.getElementById('textoAtual').textContent = 'Navegador incompatÃ­vel. Use Chrome ou Edge.';
      } else {
        const recognition = new SR();
        recognition.lang = 'pt-BR';
        recognition.continuous = true;
        recognition.interimResults = false;

        recognition.onresult = (event) => {
          for (let i = event.resultIndex; i < event.results.length; i++) {
            const res = event.results[i];
            if (res.isFinal) {
              const frase = res[0].transcript.trim();
              navigator.clipboard.writeText(frase).then(() => {
                document.getElementById('textoAtual').textContent = frase;
                console.log('Texto copiado para VLibras:', frase);
              });
            }
          }
        };

        recognition.onerror = (e) => {
          console.error('Erro no reconhecimento:', e.error);
          document.getElementById('textoAtual').textContent = 'Erro: ' + e.error;
        };

        recognition.start();
      }
    </script>
  </body>
</html>
